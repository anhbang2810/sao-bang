<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Sao băng - Kieu Oanh</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: black;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>
<canvas id="starCanvas"></canvas>

<script>
const canvas = document.getElementById("starCanvas");
const ctx = canvas.getContext("2d");
let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;

let stars = [];
let meteors = [];
let backgroundStars = [];

// Tạo nền sao tĩnh
function createBackgroundStars(count) {
    for (let i = 0; i < count; i++) {
        backgroundStars.push({
            x: Math.random() * W,
            y: Math.random() * H,
            r: Math.random() * 1.2,
            alpha: Math.random()
        });
    }
}

// Tạo sao từ chữ
function createStarsFromText(text) {
    stars = [];
    let tempCanvas = document.createElement("canvas");
    let tempCtx = tempCanvas.getContext("2d");
    tempCanvas.width = W;
    tempCanvas.height = H;
    tempCtx.fillStyle = "white";
    tempCtx.font = "bold 150px Arial";
    tempCtx.textAlign = "center";
    tempCtx.textBaseline = "middle";
    tempCtx.fillText(text, W/2, H/2);

    let imageData = tempCtx.getImageData(0, 0, W, H).data;
    for (let y = 0; y < H; y += 3) {
        for (let x = 0; x < W; x += 3) {
            let index = (y * W + x) * 4;
            if (imageData[index + 3] > 128) {
                stars.push({
                    x: x,
                    y: y,
                    size: Math.random() * 1.5 + 0.5,
                    phase: Math.random() * Math.PI * 2
                });
            }
        }
    }
}

// Tạo sao băng với đuôi gradient
function createMeteor() {
    return {
        x: Math.random() * W,
        y: -50,
        length: Math.random() * 120 + 80,
        speed: Math.random() * 8 + 5,
        angle: Math.PI / 4,
        alpha: 1
    };
}

function drawBackgroundStars() {
    ctx.save();
    ctx.globalAlpha = 0.8;
    ctx.fillStyle = "white";
    backgroundStars.forEach(s => {
        ctx.globalAlpha = 0.4 + 0.6 * Math.sin(Date.now() / 1000 + s.alpha * 10);
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.restore();
}

function drawTextStars() {
    stars.forEach(s => {
        let twinkle = 0.5 + 0.5 * Math.sin(Date.now() / 500 + s.phase);
        ctx.globalAlpha = twinkle;
        ctx.fillStyle = "white";
        ctx.beginPath();
        ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
        ctx.fill();
    });
    ctx.globalAlpha = 1;
}

function drawMeteors() {
    meteors.forEach((m, i) => {
        const x2 = m.x - Math.cos(m.angle) * m.length;
        const y2 = m.y - Math.sin(m.angle) * m.length;
        let grad = ctx.createLinearGradient(m.x, m.y, x2, y2);
        grad.addColorStop(0, `rgba(255,255,255,${m.alpha})`);
        grad.addColorStop(1, "rgba(255,255,255,0)");
        ctx.strokeStyle = grad;
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(m.x, m.y);
        ctx.lineTo(x2, y2);
        ctx.stroke();

        // Đầu sao băng sáng
        ctx.beginPath();
        ctx.fillStyle = `rgba(255,255,255,${m.alpha})`;
        ctx.arc(m.x, m.y, 2.5, 0, Math.PI * 2);
        ctx.fill();

        m.x += Math.cos(m.angle) * m.speed;
        m.y += Math.sin(m.angle) * m.speed;
        m.alpha -= 0.002;

        if (m.x > W + 100 || m.y > H + 100 || m.alpha <= 0) {
            meteors.splice(i, 1);
        }
    });

    if (Math.random() < 0.04) {
        meteors.push(createMeteor());
    }
}

function animate() {
    ctx.fillStyle = "rgba(0,0,20,0.2)";
    ctx.fillRect(0, 0, W, H);
    drawBackgroundStars();
    drawTextStars();
    drawMeteors();
    requestAnimationFrame(animate);
}

createBackgroundStars(150);
createStarsFromText("Kieu Oanh");
animate();

window.addEventListener("resize", () => {
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
    backgroundStars = [];
    createBackgroundStars(150);
    createStarsFromText("Kieu Oanh");
});
</script>
</body>
</html>
